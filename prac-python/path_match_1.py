from sys import maxsize

cam_list_0 = []

cam_list_0.append("s3://bucket/some/s3/path/cam1/1624053543.973300076.jpg")
cam_list_0.append("s3://bucket/some/s3/path/cam1/1624053544.073143005.jpg")
cam_list_0.append("s3://bucket/some/s3/path/cam1/1624053544.106466055.jpg")
cam_list_0.append("s3://bucket/some/s3/path/cam1/1624053544.139755964.jpg")
cam_list_0.append("s3://bucket/some/s3/path/cam1/1624053544.239768028.jpg")
cam_list_0.append("s3://bucket/some/s3/path/cam1/1624053544.273108959.jpg")
cam_list_0.append("s3://bucket/some/s3/path/cam1/1624053544.306571007.jpg")
cam_list_0.append("s3://bucket/some/s3/path/cam1/1624053544.339740992.jpg")
cam_list_0.append("s3://bucket/some/s3/path/cam1/1624053544.373106003.jpg")
cam_list_0.append("s3://bucket/some/s3/path/cam1/1624053544.639657974.jpg")
cam_list_0.append("s3://bucket/some/s3/path/cam1/1624053544.673021078.jpg")
cam_list_0.append("s3://bucket/some/s3/path/cam1/1624053544.706377983.jpg")
cam_list_0.append("s3://bucket/some/s3/path/cam1/1624053544.739775896.jpg")
cam_list_0.append("s3://bucket/some/s3/path/cam1/1624053544.773024082.jpg")
cam_list_0.append("s3://bucket/some/s3/path/cam1/1624053544.806375027.jpg")
cam_list_0.append("s3://bucket/some/s3/path/cam1/1624053544.906409025.jpg")
cam_list_0.append("s3://bucket/some/s3/path/cam1/1624053544.939626932.jpg")
cam_list_0.append("s3://bucket/some/s3/path/cam1/1624053544.973072052.jpg")
cam_list_0.append("s3://bucket/some/s3/path/cam1/1624053545.006361961.jpg")

cam_list_1 = []

cam_list_1.append("s3://bucket/some/s3/path/cam2/1624053543.876003027.jpg")
cam_list_1.append("s3://bucket/some/s3/path/cam2/1624053544.075928926.jpg")
cam_list_1.append("s3://bucket/some/s3/path/cam2/1624053544.109287977.jpg")
cam_list_1.append("s3://bucket/some/s3/path/cam2/1624053544.142564058.jpg")
cam_list_1.append("s3://bucket/some/s3/path/cam2/1624053544.242569923.jpg")
cam_list_1.append("s3://bucket/some/s3/path/cam2/1624053544.275943041.jpg")
cam_list_1.append("s3://bucket/some/s3/path/cam2/1624053544.309273958.jpg")
cam_list_1.append("s3://bucket/some/s3/path/cam2/1624053544.342508078.jpg")
cam_list_1.append("s3://bucket/some/s3/path/cam2/1624053544.375942945.jpg")
cam_list_1.append("s3://bucket/some/s3/path/cam2/1624053544.642474890.jpg")
cam_list_1.append("s3://bucket/some/s3/path/cam2/1624053544.675848007.jpg")
cam_list_1.append("s3://bucket/some/s3/path/cam2/1624053544.709172964.jpg")
cam_list_1.append("s3://bucket/some/s3/path/cam2/1624053544.742455959.jpg")
cam_list_1.append("s3://bucket/some/s3/path/cam2/1624053544.775701046.jpg")
cam_list_1.append("s3://bucket/some/s3/path/cam2/1624053544.809158087.jpg")
cam_list_1.append("s3://bucket/some/s3/path/cam2/1624053544.909204006.jpg")
cam_list_1.append("s3://bucket/some/s3/path/cam2/1624053544.942493916.jpg")
cam_list_1.append("s3://bucket/some/s3/path/cam2/1624053544.975824118.jpg")
cam_list_1.append("s3://bucket/some/s3/path/cam2/1624053545.009516954.jpg")

cam_list_2 = []

cam_list_2.append("s3://bucket/some/s3/path/cam3/1624053543.875010967.jpg")
cam_list_2.append("s3://bucket/some/s3/path/cam3/1624053544.074892998.jpg")
cam_list_2.append("s3://bucket/some/s3/path/cam3/1624053544.108381987.jpg")
cam_list_2.append("s3://bucket/some/s3/path/cam3/1624053544.141648054.jpg")
cam_list_2.append("s3://bucket/some/s3/path/cam3/1624053544.241525888.jpg")
cam_list_2.append("s3://bucket/some/s3/path/cam3/1624053544.274868011.jpg")
cam_list_2.append("s3://bucket/some/s3/path/cam3/1624053544.308345079.jpg")
cam_list_2.append("s3://bucket/some/s3/path/cam3/1624053544.341608047.jpg")
cam_list_2.append("s3://bucket/some/s3/path/cam3/1624053544.374803066.jpg")
cam_list_2.append("s3://bucket/some/s3/path/cam3/1624053544.641565084.jpg")
cam_list_2.append("s3://bucket/some/s3/path/cam3/1624053544.674841881.jpg")
cam_list_2.append("s3://bucket/some/s3/path/cam3/1624053544.708074093.jpg")
cam_list_2.append("s3://bucket/some/s3/path/cam3/1624053544.741399050.jpg")
cam_list_2.append("s3://bucket/some/s3/path/cam3/1624053544.774694920.jpg")
cam_list_2.append("s3://bucket/some/s3/path/cam3/1624053544.808099985.jpg")
cam_list_2.append("s3://bucket/some/s3/path/cam3/1624053544.908274889.jpg")
cam_list_2.append("s3://bucket/some/s3/path/cam3/1624053544.941382885.jpg")
cam_list_2.append("s3://bucket/some/s3/path/cam3/1624053544.974781990.jpg")
cam_list_2.append("s3://bucket/some/s3/path/cam3/1624053545.008025885.jpg")

point_list_0 = []

point_list_0.append("s3://bucket/some/s3/path/points1/1624053544.000020504.pcd")
point_list_0.append("s3://bucket/some/s3/path/points1/1624053544.100117207.pcd")
point_list_0.append("s3://bucket/some/s3/path/points1/1624053544.200195789.pcd")
point_list_0.append("s3://bucket/some/s3/path/points1/1624053544.299964905.pcd")
point_list_0.append("s3://bucket/some/s3/path/points1/1624053544.499864101.pcd")
point_list_0.append("s3://bucket/some/s3/path/points1/1624053544.599949121.pcd")
point_list_0.append("s3://bucket/some/s3/path/points1/1624053544.700036526.pcd")
point_list_0.append("s3://bucket/some/s3/path/points1/1624053545.100095749.pcd")

point_list_1 = []

point_list_1.append("s3://bucket/some/s3/path/points2/1624053543.999921322.pcd")
point_list_1.append("s3://bucket/some/s3/path/points2/1624053544.100004435.pcd")
point_list_1.append("s3://bucket/some/s3/path/points2/1624053544.200102806.pcd")
point_list_1.append("s3://bucket/some/s3/path/points2/1624053544.299882412.pcd")
point_list_1.append("s3://bucket/some/s3/path/points2/1624053544.599810600.pcd")
point_list_1.append("s3://bucket/some/s3/path/points2/1624053544.699927807.pcd")
point_list_1.append("s3://bucket/some/s3/path/points2/1624053544.999863625.pcd")
point_list_1.append("s3://bucket/some/s3/path/points2/1624053545.099984646.pcd")

point_list_0.extend(point_list_1)
combined_point_list = point_list_0

cam_dict_0 = {}

for cam in cam_list_0:
    rfind_pcd_res = cam.rfind(".")
    rfind_slash_res = cam.rfind("/")
    cam_timestamp = float(cam[rfind_slash_res + 1 : rfind_pcd_res])
    cam_dict_0[cam] = cam_timestamp

cam_dict_1 = {}

for cam in cam_list_1:
    rfind_pcd_res = cam.rfind(".")
    rfind_slash_res = cam.rfind("/")
    cam_timestamp = float(cam[rfind_slash_res + 1 : rfind_pcd_res])
    cam_dict_1[cam] = cam_timestamp

cam_dict_2 = {}

for cam in cam_list_2:
    rfind_pcd_res = cam.rfind(".")
    rfind_slash_res = cam.rfind("/")
    cam_timestamp = float(cam[rfind_slash_res + 1 : rfind_pcd_res])
    cam_dict_2[cam] = cam_timestamp

images_list = []
images_list.append(cam_dict_0)
images_list.append(cam_dict_1)
images_list.append(cam_dict_2)

print("images_list: {}".format(images_list))

print("combined_point_list has {} elements".format(len(combined_point_list)))
print("images_list has {} elements".format(len(images_list)))

print("cam_list_0 has {} elements".format(len(cam_list_0)))
print("cam_list_1 has {} elements".format(len(cam_list_1)))
print("cam_list_2 has {} elements".format(len(cam_list_2)))

point_combos = {}

for point in combined_point_list:
    rfind_pcd_res = point.rfind(".pcd")
    rfind_slash_res = point.rfind("/")
    point_timestamp = float(point[rfind_slash_res + 1 : rfind_pcd_res])
    # print("point_timestamp: {}".format(point_timestamp))

    combined_image_list = []
    for images in images_list:
        recent_minimum = maxsize
        recent_minimum_key = None
        for image_key in images:
            # print("image_key: {}".format(image_key))
            difference = abs(images[image_key] - point_timestamp)
            if difference < recent_minimum:
                # print("found new: {} {}".format(images[image_key], image_key))
                recent_minimum = difference
                recent_minimum_key = image_key
        if recent_minimum_key is not None:
            combined_image_list.append(recent_minimum_key)
            # print("point: {} is closest to: {}".format(point, recent_minimum_key))
    point_combos[point] = combined_image_list

# print(point_combos)